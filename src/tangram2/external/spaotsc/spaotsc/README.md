Modified version of: https://github.com/zcang/SpaOTsc
